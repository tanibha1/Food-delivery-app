var __assign,__spreadArray,SvCtrlV2;(function(n){n.ColListName="ColLst";n.SavableEntityCN="isv";n.SavedCN="saved";n.SaveCtrlContainerCN="isvctrl";n.FlyoutErrorCN="err";n.InProgressCN="ing";n.GetErrCN="b_geterr";n.FocusCN="isvfoc";n.HoverCN="b_isvhvr";n.SaveCtrlHoveredCN="b_schvr";n.CurrentElementCN="b_isvcur";n.NarrowImageCN="b_nrrwimg";n.NarrowImageRightCN="b_nrrwimgr";n.NarrowImageBottomCN="b_nrrwimgb";n.HasFlyoutCN="b_flyt";n.FlyoutActiveCN="b_scactive";n.SublabelActiveCN="b_scslbl";n.ErrDispCN="b_scdisp";n.DeactivateCN="scdactve";n.errStateVisibleCN="errvsbl";n.errStateInvisibleCN="errinvsbl";n.RemovableCN=[n.SavedCN,n.FocusCN,n.HoverCN,n.InProgressCN,n.FlyoutErrorCN,n.SaveCtrlHoveredCN];n.CollectionAttr="collection";n.CollectionItemIdAttr=n.CollectionAttr+"ItemId";n.IsSuccessAttr="isSuccess";n.ParentElementAttr="parentElement";n.UndefinedString="undefined";n.RelatedTargetAttr="relatedTarget";n.CurrentTargetAttr="currentTarget";n.TargetAttr="target";n.PixelUnit="px";n.SavesGenericItemDataAttr="data-saves-generic-item";n.ScrollBindDataAttr="data-scrbind";n.ClassListAttr="classList";n.CollectionIdDataAttribute="data-svcid";n.KCTDataAttr="data-svkct";n.SavedDataAttr="data-svd";n.SaveErrorMapAttr="data-save-error-map";n.CollRegisterEN="onCollRegister";n.PartnerRegisterEN="onPartnerRegister";n.DeregisterPersBtnEN="onDeregisterPersBtn";n.UpdateHoverBoxEN="onUpdateHoverBox";n.scEngagementEN="onSCEngagement";n.FocusInEN=["mouseenter","focusin"];n.FocusOutEN=["mouseleave","focusout"];n.CollListExpandEN="onCollListExpand";n.VisualStateChangedEN="onVisualStateChanged";n.CollectionsGottenEN="onCollectionsGotten";n.HostSavesControlClickedEN="onHostSavesControlClicked";n.PersButtonInteractEN="onPersButtonInteract";n.SaveAddEN="onSaveAdd";n.SaveDelEN="onSaveDel";n.SaveControlErrorEN="onSaveControlError";n.ControlAppendedEN="onControlAppended";n.CurrentCollIdSetEN="onCurrentCollIdSet";n.HoverElementSetEN="onHoverElementSet";n.SaveButtonClickEN="onSaveButtonClick";n.SaveButtonFocusEN="onSaveButtonFocus";n.ChevronToggleCollListEN="onBtnToggleCollList";n.FavAddEN="onFavAdd";n.FavDeleteEN="onFavDel";n.CollBCLoadedEN="CollectionsBCLoaded";n.CurrentElementSetEN="onCurrentElementSet";n.UpdateSaveStateEN="updateSaveState";n.LoadingSuggestedCollection="loadingSuggestedCollection";n.CurrentCollIdUnsetEN="onCurrentCollIdUnset";n.TypeToAttributeMap={webdoc:"url",recipe:"sid",video:"mid",image:"cid",product:"cid"};n.ScrollEvent="scroll";n.ResizeEvent="resize";n.CustomCollDummyId="CustomCollId";n.IcnsBGColorCss="--icn-bg-color";n.IcnLblTxtClrCss="--svlbl-txt-color";n.SavedIcnCss="--svicn-bg-img";n.UnsavedIcnCss="--unsvicn-bg-img";n.SavedPromIcnCss="--svicn-bg-img-prominent";n.UnsavedPromIcnCss="--unsvicn-bg-img-prominent";n.SavePromClrCss="#5087EC";n.SavePromTxtClrCss="#FFFFFF";n.FlyoutBGClrCss="--flyout-bg-clr";n.FlyoutLnkClrCss="--flyout-lnk-clr";n.FlyoutTxtClrCss="--flyout-txt-clr";n.UiErrorStates=["Ok","AddItem","RemoveItem","GetCollection","CreateCollection","Mismatch","Intermittent","BadItemData"]})(SvCtrlV2||(SvCtrlV2={})),function(n){function v(t){return t&&c(t,n.SavableEntityCN)}function y(n,t){return!n&&!t?"":n?t?"type=".concat(n,"&Comp=").concat(t):"type=".concat(n):"Comp=".concat(t)}function i(n,t){try{var i=_d.elementsFromPoint(n,t)||[];return Array.prototype.slice.call(i)}catch(r){return[]}}function r(n,t){for(var f,r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];for(f=n&&n.length||0,r=0;r<f;r++)t(n[r],u)}function p(n){try{return JSON.parse(n)}catch(t){return null}}function f(n,t){if(n)for(var i in n)t(i,n[i])}function w(n,t){var i=n;return f(t,function(n,t){i[n]=t}),i}function b(n){if(n&&n.target){var t=n.target.getBoundingClientRect(),u=t.x,f=t.right,e=t.y,o=t.bottom,s=i((u+f)/2,(e+o)/2);r(s,function(n){n.tagName==="A"&&n.hasAttribute("h")&&_w.si_T&&_w.si_T(n.getAttribute("h"))})}}function k(n,t){if(!(n&&t))return!1;try{return n.contains(t)}catch(i){return!1}}function e(n){if(!n)return null;try{return n.getBoundingClientRect()}catch(t){return null}}function d(n,t){var r;if(!(n&&t))return!1;try{if(r=e(n),!r)return;var u=r.x,f=r.y,o=i(u,f);return nt(o,t)}catch(s){return!1}}function g(t){var i,r;if(!t||!n.localCollectionNames)return!1;i=t.toLowerCase();for(r in n.localCollectionNames)if(i==r.toLowerCase())return!0;return!1}function nt(n,t){try{return n&&n.length&&n.indexOf(t)>-1}catch(i){return!1}}function tt(n,t){var i,r;return!n||!t?null:Element.prototype.closest?n.closest(t):(i=Element.prototype.matches?Element.prototype.matches:Element.prototype.webkitMatchesSelector?Element.prototype.webkitMatchesSelector:Element.prototype.msMatchesSelector,!i)?null:(r=function(n,t){var r=n;do{if(i.call(r,t))return r;r=r.parentElement||r.parentNode}while(r&&r.nodeType===1);return null},r(n,t))}function o(n){return n&&n.tagName==="A"}function t(n,t,i){n&&t&&i&&n.addEventListener(t,i)}function s(n,i){t(n,"keydown",function(n){n.keyCode==13&&i(n)})}function it(n,i,r,u){if(r===void 0&&(r=!0),u===void 0&&(u=!0),n&&i){var f=o(n)?i:function(n){u&&(sj_pd(n),n.stopImmediatePropagation());i(n)};t(n,"click",f);r&&s(n,f)}}function rt(t,i){t&&i&&h(t,n.FocusInEN,i)}function ut(t,i){t&&i&&h(t,n.FocusOutEN,i)}function h(n,i,u){n&&u&&r(i,function(i){t(n,i,u)})}function c(t,i){if(!t||!i)return!1;var r=t[n.ClassListAttr];return r&&r.contains(i)}function l(t,i,r){t&&t[n.ClassListAttr]&&t[n.ClassListAttr][r](i)}function a(n,t){l(n,t,"add")}function u(n,t){l(n,t,"remove")}function ft(n,t,i){n&&(a(n,i),u(n,t))}function et(t){t&&u(t,n.InProgressCN)}function ot(n,t){var i,r,u;if(!(t&&t.content&&n))return!1;i=t.content;switch(i._type){case"ImageObject":return i.imageId===n.MediaId;case"VideoObject":return i.videoId===n.MediaId;case"GenericItem":if(n.ItemTagPath!==i.itemTagPath)return!1;if("contentId"in i&&"ContentId"in n)return i.contentId===n.ContentId;if(n.ClickThroughUrl!==i.url)return!1;if("CustomData"in n&&"customData"in i)try{if(r=JSON.parse(n.CustomData),u=JSON.parse(i.customData),"MediaUrl"in r||"MediaUrl"in u)return r.MediaUrl===u.MediaUrl}catch(f){return!1}return!0}return!1}function st(n,t){var r=this,i;return t===void 0&&(t=300),function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];sb_ct(i);i=sb_st(function(){n.apply(r,f)},t)}}function ht(t){var i;if(!t)return"";if(t.turl)return t.turl;if(i=t.ThumbnailInfo,i&&i.length>=1){var r=i[0],u=r.Thumbnail,f=r.ThumbnailId,e=r.ExternalThumbnailUrl;return u||"".concat(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.bngd,"/th?id=").concat(f)||e}return""}function ct(n){var i=[];for(var t in n)n.hasOwnProperty(t)&&i.push(t,n[t]);return i.map(function(n){return n!=null&&n.toString!=null?n.toString():"undefined"})}n.isSavableEntity=v;n.getUrlParamsForTelemetry=y;n.elementsFromPoint=i;n.iterateThroughList=r;n.parseJsonString=p;n.iterateOverObject=f;n.objectAssign=w;n.fireOverlapping=b;n.elementContains=k;n.getClientRect=e;n.isElementInSpaceOfAnother=d;n.isCollectionExists=g;n.getClosest=tt;n.isAnchorElement=o;n.addListenerToElement=t;n.addEnterKeyListener=s;n.addClickListener=it;n.addInListeners=rt;n.addOutListeners=ut;n.elementHasClass=c;n.addElementClass=a;n.removeElementClass=u;n.switchElementClass=ft;n.removeInProgress=et;n.isDataPointingToSameItem=ot;n.debounce=st;n.getThumnailFromItemMD=ht;n.flattenObjToStrArray=ct}(SvCtrlV2||(SvCtrlV2={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){function r(r,u,f,e){var h=1,c=n.currentHoveredItem.Element;if(c){var l=f in Constants.PredefinedCollections,a=l?Constants.PredefinedCollections[f]:null,o=__assign({},n.currentHoveredItem),s=o.Metadata;if(c.hasAttribute(n.SavesGenericItemDataAttr)&&typeof t.addEdgeGenericItem!==n.UndefinedString){t.addEdgeGenericItem(n.parseJsonString(c.getAttribute(n.SavesGenericItemDataAttr)),f,function(n){return r(n,o,!0,e,!1,f)},function(){return u(h,o.Element)},n.currentCompName);return}if(!s){u(7,o.Element);return}i(s)&&typeof t.addGenericItem!==n.UndefinedString?t.addGenericItem(n.currentUrlParams,s,n.itemSchema,n.itemTagPath,l?a:null,n.localCollectionsMap[f],f,n.partnerKey,null,function(n){return r(n,o,!0,e,!1,f)},function(){return u(h,o.Element)}):typeof t.addNonGenericItem!==n.UndefinedString&&t.addNonGenericItem(n.currentUrlParams,s,n.defaultItemType,n.itemSchema,f,l?a:null,n.localCollectionsMap[f],function(n){return r(n,o,!1,e,!1,f)},function(){return u(h,o.Element)})}}function u(r,u,f,e){var h,c,o,s;if(e===void 0&&(e="Flyt"),h=1,c=n.currentHoveredItem.Element,c){if(o=__assign({},n.currentHoveredItem),s=o.Metadata,c.hasAttribute(n.SavesGenericItemDataAttr)&&typeof t.addEdgeGenericItemToNewColl!==n.UndefinedString){t.addEdgeGenericItemToNewColl(n.parseJsonString(c.getAttribute(n.SavesGenericItemDataAttr)),f,function(n){return r(n,o,!0,e,!0,"",f)},function(){return u(h,o.Element)},n.currentCompName);return}if(!s){u(7,o.Element);return}i(s)&&typeof t.addGenericItem!==n.UndefinedString?t.addGenericItem(n.currentUrlParams,s,n.itemSchema,n.itemTagPath,null,f,null,n.partnerKey,n.collTagPath,function(n){return r(n,o,!0,e,!0,"",f)},function(){return u(h,o.Element)}):f&&typeof t.addNonGenericItem!==n.UndefinedString&&t.addNonGenericItem(n.currentUrlParams,s,n.defaultItemType,n.itemSchema,null,null,f,function(n){return r(n,o,!1,e,!0,"",f)},function(){return u(h,o.Element)})}}function f(r,u,f,e){var c=2,l=n.currentHoveredItem.Element,h;if(l){var o=__assign({},n.currentHoveredItem),a=o.Mid,s=n.localSavedItemsMap[a];s&&((l.hasAttribute(n.SavesGenericItemDataAttr)||i(o.Metadata))&&typeof t.deleteGenericItem!==n.UndefinedString?t.deleteGenericItem(n.currentUrlParams,s.cid,n.kctColls[f]||f,function(n){return r(n,o,f,e)},function(){return u(c,o.Element)}):typeof t.deleteNonGenericItem!==n.UndefinedString&&(h=f in Constants.PredefinedCollections,t.deleteNonGenericItem(n.currentUrlParams,h?Constants.PredefinedCollections[f]:"",h?"":f,s.cid,n.defaultItemType,function(n){return r(n,o,f,e)},function(){return u(c,o.Element)})))}}function i(t,i){return(i===void 0&&(i=n.defaultItemType),!t)?!1:!("mid"in t)&&i!=="recipe"}var t=MySavesAPIUtils;n.addToCollection=r;n.addToNewCollection=u;n.removeFromCollection=f}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(t){if(n.itemSchema||(n.itemSchema={}),t&&t.length>0){var i=t.split(":"),r=i[0],u=i[1];n.itemSchema[r]=u}}function i(t){var i;if(!t)return null;if(i=t.dataset,i){var r=i.svptnk,u=i.svptnerinfo,f=i.svitminfp,e=i.svcptid,o=i.ufmc,s=i.sfmc,h=i.svstb,c=i.svmdcmp,l=i.svloc,a=i.svattr,v=i.persbtncls,y=i.cstmuiobj,p=n.parseJsonString(u)||{},w=n.parseJsonString(y)||{};return n.objectAssign(n.parseJsonString(f)||{},{PredefinedType:p,Key:r,ComponentId:e,UnsavedFormCode:o,SavedFormCode:s,SavedLinkSameTab:!!h,MetaLocInfo:{MetadataLocationId:l,MetadataLocationAttr:a,MetaLocCompName:c},PersButtonClassName:v,CustomUIObj:w})}}function r(){if(n.singlePartner){var r=n.singlePartner.Mapping,u=n.singlePartner.SavedFormCode,f=n.singlePartner.SavedLinkSameTab,i=n.singlePartner.PredefinedType,e=i.Title,o=i.CollectionTagPath,s=i.PredefinedCollectionType,h=i.ItemType,c=i.APIItemType,l=n.singlePartner.Key,a=n.singlePartner.SourceAttr,v=n.singlePartner.ItemTagPath,y=n.singlePartner.AttachToElementSelector,p=n.singlePartner.AttachDelay,w=n.singlePartner.ComponentId,b=n.singlePartner.PersButtonClassName,k=n.singlePartner.CustomUIObj;r&&n.iterateThroughList(r.split(","),t);h&&(n.defaultItemType=h);l&&(n.partnerKey=l);s&&(n.defaultCollectionType=s);e&&(n.defOrCustCollName=e);o&&(n.collTagPath=o);v&&(n.itemTagPath=v);w&&(n.compName=w);a&&(n.sourceAttribute=a);c&&(n.apiItemType=c);y&&(n.attachElementSelector=y,p&&(n.attachDelay=p));u&&(n.savedFormCode=u);f&&(n.savedLinkSameTab=f);n.apiItemType&&n.compName&&(n.urlParams=n.getUrlParamsForTelemetry(n.apiItemType,n.compName));b&&(n.persistentButtonClassName=b);k&&(n.customUIObj=k)}}function u(t,u){var f=t&&t.getAttribute("data-svcptid"),e;f&&!n.componentMap[f]&&(e=i(t),n.componentMap[f]=e,n.partnerCount++,n.partnerCount===1&&(n.singlePartner=e,r()));u&&u(t)}n.componentMap={};n.partnerCount=0;n.registerPartnerAndComponent=u}(SvCtrlV2||(SvCtrlV2={}));__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},function(n){function d(){var i={ItmId:n.currentHoveredItem.Mid,CompName:n.currentCompName};t(r,a,i)}function g(){var i={CompName:n.currentCompName,HvrSrc:u};t(e,"",i)}function nt(n){var i={ColCount:n};t(f,l,i)}function tt(r,u){var f={ColId:u,CollName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:y};t(i,"",f)}function it(){var r={CompName:n.currentCompName,ClkSrc:p};t(i,"",r)}function rt(r,u){var f={ColId:u,ColName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:v};t(i,"",f)}function ut(){var r={CompName:n.currentCompName,Clksrc:w};t(i,"",r)}function ft(){var r={CompName:n.currentCompName,Clksrc:u};t(i,"",r)}function et(i,u,f,e,o){var s={ColId:o,ItmId:u,CompName:n.currentCompName,ClkSrc:f,IsNewCol:e?"1":"0"};t(r,h,s)}function ot(i,u,f,e){var o={ColId:u,ItmId:f,CompName:n.currentCompName,ClkSrc:e};t(r,c,o)}function st(i,r){var u={CompName:n.currentCompName,ErrorType:r};t(o,b,u)}function t(t,i,r){i===void 0&&(i="");r===void 0&&(r=null);var u=n.flattenObjToStrArray(r);ht.apply(void 0,__spreadArray([t,k,i],u,!1))}function ht(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];typeof Log!="undefined"&&Log.Log&&Log.Log.apply(Log,__spreadArray([n,"",s,!1],i,!1))}var f="Saves",e="Hover",i="SaveClick",r="Success",o="SaveErr",s="SaveControl",h="Saved",c="Unsaved",l="GetCollections",a="ShowFlyout",v="LnkClk",y="ColLst",p="CrtNewBtn",w="ColExp",u="SvCtrlBtn",b="UIState",k="Txt";n.logFlyoutShown=d;n.logSvBtnHoverEvent=g;n.logGetCollectionsSucceeded=nt;n.logCollLstClick=tt;n.logCreateButtonClick=it;n.logLinkClick=rt;n.logCollExpandClick=ut;n.logSaveControlBtnClick=ft;n.logAddItemSucceeded=et;n.logDeleteItemSucceeded=ot;n.logErrorState=st}(SvCtrlV2||(SvCtrlV2={})),function(n){function f(n){pt=n}function e(){return pt}function a(){n.removeElementClass(n.currentHoveredItem.Element,n.CurrentElementCN);n.currentHoveredItem.LatestCollId&&(sj_evt.fire(n.CurrentCollIdUnsetEN,n.currentHoveredItem.LatestCollId),n.currentHoveredItem.LatestCollId=null);n.currentHoveredItem.Element=null;n.currentHoveredItem.Turl=null;n.currentHoveredItem.Metadata=null;n.currentHoveredItem.Mid=null}function o(t,i){var r,u;return(i===void 0&&(i=n.sourceAttribute),!t)?null:(r=t.hasAttribute(i)?t:ct(t,i),!r)?null:(u=r.getAttribute(i),!u)?null:n.parseJsonString(u)}function sr(){if(n.currentElementTemp){var t=n.currentElementTemp;return n.currentElementTemp=null,t}}function ti(n){var r,t,i,u,f;if(n&&n.items){for(r=n.items,t=r.length-1;t>=0;t--)if(i=r[t],i&&i.content){if(u=i.content,!u)continue;if(f=ei(u),f)return f}return null}}function ot(n){if(n){var t=n.mid,i=n.sid;return t||i}}function hr(t,f,e){var h,o=n.currentHoveredItem.Element,s;if(o){if(n.logSaveControlBtnClick(o),sj_evt.fire("onSaveInProgress",o),t==n.CustomCollDummyId){n.addToNewCollection(u,function(t,r){n.removeCollectionFromPicker(n.CustomCollDummyId);i(t,r)},n.defOrCustCollName);return}s=n.elementHasClass(o,n.SavedCN)||n.elementHasClass(n.hoverContainerSub,n.SavedCN);!s&&(n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[n.currentHoveredItem.Mid])&&(s=!0);r?((h=n.localSavedItemsMap[n.currentHoveredItem.Mid])===null||h===void 0?void 0:h.collections[n.latestCollId])?n.removeFromCollection(at,i,t,f):n.addToCollection(u,i,t,f):s?e&&n.removeFromCollection(at,i,t,f):n.addToCollection(u,i,t,f)}}function cr(t){var f=t.currentTarget,r=f.getAttribute(n.CollectionIdDataAttribute),e=f.getAttribute(n.KCTDataAttr);if(r||e)sj_sp(t),sj_pd(t),t.stopImmediatePropagation();else return!0;if(n.logCollLstClick(n.currentHoveredItem.Element,r),r==n.CustomCollDummyId){n.addToNewCollection(u,function(t,r){n.removeCollectionFromPicker(n.CustomCollDummyId);i(t,r)},n.defOrCustCollName,n.ColListName);return}f.hasAttribute(n.SavedDataAttr)?n.removeFromCollection(at,i,r,n.ColListName):n.addToCollection(u,i,r,n.ColListName)}function ii(){t&&t.broadcastMessage(t.BCActionMessage)}function st(t,i,r,u,f){n.standalone&&sj_evt.fire(n.scEngagementEN,t,i,r,u,f)}function ri(t){var i,r,u;if(h)for(i in n.localSavedItemsMap)if(r=n.localSavedItemsMap[i],r.rawItem&&(u=r.rawItem,n.isDataPointingToSameItem(t,u)))return i;return null}function v(t,i,u,f){var v,c,l,s,a,p,w;i===void 0&&(i=n.sourceAttribute);u===void 0&&(u=n.urlParams);f===void 0&&(f=n.compName);n.addElementClass(t,n.CurrentElementCN);n.currentHoveredItem.Element=t;var e=o(t,i)||o(t,n.SavesGenericItemDataAttr),y=ct(t,or),h=y===null||y===void 0?void 0:y.ariaLabel,b=h&&h!=n.currentImgTitle&&gt;if(e&&(n.currentHoveredItem.Metadata=e,n.currentHoveredItem.Mid=ot(e)||ri(e),n.currentHoveredItem.Turl=n.getThumnailFromItemMD(e),c=e.type,c&&c!==n.defaultItemType&&(n.defaultItemType=c),l={},s=n.currentHoveredItem.Mid,s?((n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[s])?(n.currentHoveredItem.LatestCollId=n.localSavedItemsMap[s].lastCollection,n.currentHoveredItem.LatestCollId&&sj_evt.fire(n.CurrentCollIdSetEN,n.currentHoveredItem.LatestCollId),l=n.localSavedItemsMap[s].collections,(!r||((v=n.localSavedItemsMap[s])===null||v===void 0?void 0:v.collections[n.latestCollId]))&&(n.addElementClass(t,n.SavedCN),n.addElementClass(n.hoverContainerSub,n.SavedCN))):n.removeElementClass(n.hoverContainerSub,n.SavedCN),b||sj_evt.fire(n.HoverElementSetEN,l)):(n.removeElementClass(n.hoverContainerSub,n.SavedCN),n.removeElementClass(t,n.SavedCN),sj_evt.fire(n.HoverElementSetEN,l)),b)){sj_evt.fire(n.LoadingSuggestedCollection);n.currentImgTitle=h;var k=[],d=Object.keys(n.localCollectionsMap),nt=function(t){var i,r;((r=(i=t===null||t===void 0?void 0:t.RawResponse)===null||i===void 0?void 0:i.suggestedCollections)===null||r===void 0?void 0:r.length)>0&&(n.latestCollId=t.RawResponse.suggestedCollections[0].id);sj_evt.fire(n.CurrentCollIdSetEN,n.latestCollId)};for(a=0,p=d;a<p.length;a++)w=p[a],k.push({collectionId:w,collectionTitle:n.localCollectionsMap[w]});g.getSuggestedCollectionTitle("",k,h,"",nt,function(){sj_evt.fire(n.CurrentCollIdSetEN,n.latestCollId)})}return n.currentUrlParams=u,n.currentCompName=f,!0}function ht(t){var i,r;return t?(i=n.defaultItemType in n.TypeToAttributeMap?n.TypeToAttributeMap[n.defaultItemType]:null,!i)?t:(r=n.defaultItemType+":"+i+"=",(t.indexOf(r)!==0?r:"")+t):null}function ct(n,t){return n?_qs("["+t+"]",n):null}function y(t){var r=ct(n.containerElement,n.sourceAttribute+'*="'+t+'"'),i;if(!r)return null;for(i=r;!n.isSavableEntity(i)&&i[n.ParentElementAttr];)i=i[n.ParentElementAttr];return n.isSavableEntity(i)?i:r}function p(t,i,u,f,e,o){var s;if(t&&i){if(!(i in n.localSavedItemsMap)){n.elementHasClass(t,n.SavedCN)&&n.removeElementClass(t,n.SavedCN);return}(!r||((s=n.localSavedItemsMap[n.currentHoveredItem.Mid])===null||s===void 0?void 0:s.collections[n.latestCollId]))&&n.addElementClass(t,n.SavedCN);u&&(t&&sj_evt.fire("Saved",t),n.logAddItemSucceeded(t,i,f,e,o))}}function lt(t,i,u,f,e){var o;t&&i&&(i in n.localSavedItemsMap&&(!r||((o=n.localSavedItemsMap[i])===null||o===void 0?void 0:o.collections[n.latestCollId]))||n.removeElementClass(t,n.SavedCN),u&&(t&&sj_evt.fire("Unsaved",t),n.logDeleteItemSucceeded(t,e||rt,i,f)))}function ui(t,i,r,u,f){var e,o;t&&(t in n.localSavedItemsMap?(u&&n.localSavedItemsMap[t].lastCollection||(n.localSavedItemsMap[t].lastCollection=r),n.localSavedItemsMap[t].collections[r]||(n.localSavedItemsMap[t].collections[r]=!0,n.localSavedItemsMap[t].numCollections++),u?n.localSavedItemsMap[t].collectionQueue.unshift(r):n.localSavedItemsMap[t].collectionQueue.push(r)):(o={cid:f?i:ht(i),rawItem:f?f:null,collections:(e={},e[r]=!0,e),lastCollection:r,collectionQueue:[r],numCollections:1},n.localSavedItemsMap[t]=o))}function fi(t,i){if(t&&n.localSavedItemsMap[t])if(rt=i,n.localSavedItemsMap[t].numCollections===1)delete n.localSavedItemsMap[t],n.currentHoveredItem.Mid===t&&(n.currentHoveredItem.LatestCollId=null);else{delete n.localSavedItemsMap[t].collections[i];n.localSavedItemsMap[t].numCollections--;var r=n.localSavedItemsMap[t].collectionQueue.indexOf(i);r>-1&&(n.localSavedItemsMap[t].collectionQueue.splice(r,1),n.localSavedItemsMap[t].lastCollection=n.localSavedItemsMap[t].collectionQueue.slice(-1)[0],n.currentHoveredItem.Mid===t&&(n.currentHoveredItem.LatestCollId=n.localSavedItemsMap[t].lastCollection))}}function ei(n){var t,i;return n.thumbnailUrl||((i=(t=n.thumbnails)===null||t===void 0?void 0:t[0])===null||i===void 0?void 0:i.thumbnailUrl)}function oi(t,i,r,u){n.localCollectionsCidMap[t]||(n.localCollectionsCidMap[t]=[]);n.localCollectionsCidMap[t].indexOf(i)<=-1&&(u?n.localCollectionsCidMap[t].push(i):n.localCollectionsCidMap[t].unshift(i));n.cidToThumbnailUrlMap[i]||(n.cidToThumbnailUrlMap[i]=r)}function lr(t,i){var r,u;if(n.localCollectionsCidMap[t])return(u=n.localCollectionsCidMap[t].indexOf(i),u<=-1)?void 0:(n.localCollectionsCidMap[t].splice(u,1),((r=n.localCollectionsCidMap[t])===null||r===void 0?void 0:r[0])||null)}function ar(t,i){var r,u;return t?(r=n.parseJsonString(t.getAttribute(n.SavesGenericItemDataAttr)),r||(r=o(t,n.sourceAttribute)),!r)?null:(u={url:r.ClickThroughUrl,customData:r.CustomData,domain:r.FriendlyDomainName,itemTagPath:r.ItemTagPath,title:r.Title,_type:"GenericItem",contentId:r.ContentId},{collectionItemId:i,content:u,itemtype:"Generic"}):null}function u(t,i,u,f,e,o,s){var h,c;return(o&&o!=""||(o=(c=(h=t.targetCollectionOperationStatus)===null||h===void 0?void 0:h.collection)===null||c===void 0?void 0:c.id),!(t&&t[n.IsSuccessAttr])||!o)?!1:(r||(n.latestCollId=o,i.LatestCollId=o),sj_evt.fire(n.CurrentCollIdSetEN,o),e&&s&&(w(o,s),sj_evt.fire(n.CollRegisterEN,!0,o,s,n.currentHoveredItem.Turl,null,!0)),ii(),vr(i,t,u,f,o,e))}function at(t,i,u,f){if(!(t&&t[n.IsSuccessAttr]))return!1;r||(n.latestCollId=u,i.LatestCollId=u);sj_evt.fire(n.CurrentCollIdUnsetEN,u);var e=n.localSavedItemsMap[i===null||i===void 0?void 0:i.Mid];return ii(),yr(i,t,f,(e===null||e===void 0?void 0:e.cid)||null,u)}function vr(t,i,u,f,e,o){var v=i.targetCollectionOperationStatus,w,h,s,b,k;if(!(v&&v[n.IsSuccessAttr]))return!1;try{var d=v,g=d.itemOperationStatuses,tt=n.CollectionAttr,a=d[tt];if(!(g&&a&&a.id))return!1;var it=g,nt=it[0],rt=n.IsSuccessAttr,ut=nt[rt],ft=n.CollectionItemIdAttr,c=nt.item[ft];if(!ut)return!1;w=e in Constants.PredefinedCollections;h=w?e:a.id;r||(n.latestCollId=h);w&&(n.kctColls[e]=a.id);s=t.Mid;s||c===null||(b=c.substring(c.indexOf(":")+1),s=b,n.currentHoveredItem.Element==t.Element&&(n.currentHoveredItem.Mid=b));k=u?c:ht(c);oi(h,k,n.currentHoveredItem.Turl,!1);n.localCollectionsMap[h]&&sj_evt.fire("onChangeCollThumbnail",h,n.currentHoveredItem.Turl);var et=s?n.localSavedItemsMap[s]:!1,l=t.Element,ot=u?ar(l,c):null;return(ui(s,k,h,!1,ot),n.localSavedItemsMap[s]&&st(1,0,o?1:0,n.localSavedItemsMap[s].numCollections),l)?(p(l,s,!0,f,o,h),sj_evt.fire(n.UpdateHoverBoxEN,h,n.localCollectionsMap[h],s&&n.localSavedItemsMap[s].numCollections||1),n.isSavableEntity(l)||p(y(s),s,!1),si(n.SaveAddEN,i,s,l,!et)):!1}catch(ct){return!1}}function yr(t,i,r,u,f){var e=t.Mid,o=t.Element,h,s;return(i.collectionId=f,fi(e,f),st(0,1,0,n.localSavedItemsMap[e]?n.localSavedItemsMap[e].numCollections:0),o)?(lt(o,e,!0,r,f),h=lr(f,u),sj_evt.fire("onChangeCollThumbnail",f,h?n.cidToThumbnailUrlMap[h]:null),s=!n.localSavedItemsMap[e],s&&!n.isSavableEntity(o)&&lt(y(e),e,!1),sj_evt.fire(n.UpdateHoverBoxEN,f,n.localCollectionsMap[f],s?0:n.localSavedItemsMap[e].numCollections),si(n.SaveDelEN,i,e,o,s)):!1}function si(t,i,u,f,e){var o;if(f){if(n.removeInProgress(f),(n.currentHoveredItem===null||n.currentHoveredItem===void 0?void 0:n.currentHoveredItem.Element)===f){n.removeElementClass(n.ctrl,n.GetErrCN);switch(t){case n.SaveAddEN:(!r||((o=n.localSavedItemsMap[n.currentHoveredItem.Mid])===null||o===void 0?void 0:o.collections[n.latestCollId]))&&n.addElementClass(n.hoverContainerSub,n.SavedCN);break;case n.SaveDelEN:e&&n.removeElementClass(n.hoverContainerSub,n.SavedCN)}n.removeInProgress(n.hoverContainerSub)}sj_evt.fire(t,i,u,f,e,typeof n.metaLocElement!==n.UndefinedString&&n.metaLocElement===f)}return rt=null,!0}function i(t,i){t===3?(n.addElementClass(n.ctrl,n.GetErrCN),ut=!1):n.switchElementClass(i,n.InProgressCN,n.FlyoutErrorCN);sj_evt.fire(n.SaveControlErrorEN,t)}function pr(t){n.logGetCollectionsSucceeded(t)}function wr(n){if(!(n&&n.content&&n.itemType))return null;var t=n.content,i=n.itemType;switch(i){case"Image":return t.imageId;case"Video":return t.videoId;case"Generic":return t.contentId;default:return null}}function br(t){if(!t)return null;var u=t&&t[n.CollectionItemIdAttr],i=u?decodeURIComponent(u):"",r=wr(t);return r||(r=/^[a-z]+:[a-z]+=/.test(i)?i.substring(i.indexOf("=")+1):i.replace("/"+n.partnerKey+"/:","")),{contentId:r,collectionItemId:i}}function w(t,i){n.localCollectionsMap[t]=i;n.localCollectionNames[i]=1}function kr(t){if(!(t.length<=0)){var r=t.sort(function(n,t){return n.dateModified>t.dateModified?-1:1}),i=r[0];n.latestCollId=!i.knownCollectionType?i.id:Constants.PredefinedCollections[i.knownCollectionType]}}function dr(n,t){var r=t[0];if(n){var u=br(n),i=u.collectionItemId,f=u.contentId;f&&i&&(n.content&&oi(r,i,ei(n.content),!0),ui(f,i,r,!0,n.itemType=="Generic"?n:null))}}function gr(t){var u,e;if(t){var r=t.collectionPage,f=t.id,i=t.knownCollectionType;(i&&(n.kctColls[Constants.PredefinedCollections[i]]=f),u=!i?f:Constants.PredefinedCollections[i],n.localCollectionsMap[u]||vu(t),r&&r.items)&&(e=r.items,n.iterateThroughList(e,dr,u))}}function nu(t){var i,u,r;return(t&&t.collections)?(i=t.collections,i=i.reverse(),u=(i===null||i===void 0?void 0:i.length)||0,pr(u),n.iterateThroughList(i,gr),kr(i),sj_evt.fire("onSaveGet",t),h||(h=!0,c&&(v(c),c=null)),r=Constants.PredefinedCollections[n.defaultCollectionType],n.defaultCollectionType&&!n.localCollectionsMap[r]&&(w(r,n.defOrCustCollName),n.latestCollId||(n.latestCollId=r),sj_evt.fire(n.CollRegisterEN,!1,r,n.defOrCustCollName,null,n.defaultCollectionType)),!n.defaultCollectionType&&n.collTagPath&&n.defOrCustCollName&&!n.isCollectionExists(n.defOrCustCollName)&&(n.latestCollId=n.CustomCollDummyId,sj_evt.fire(n.CollRegisterEN,!1,n.CustomCollDummyId,n.defOrCustCollName)),n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner),sj_evt.fire("onCollectionsGotten"),!0):!1}function tu(t,i){n.hoverContainer&&n.hoverContainer.style.setProperty(t,i)}function hi(t){n.hoverContainerSub&&n.removeElementClass(n.hoverContainerSub,t)}function vt(t){n.hoverContainer&&t&&n.iterateOverObject(t,tu)}function ci(t){n.hoverContainer&&vt({display:t})}function iu(n){ni=new Date;ft===!1&&(ft=!0,setTimeout(function(){return li(n)},et))}function li(t){var u=new Date,i,r;u.getTime()-ni.getTime()<et?setTimeout(function(){return li(t)},et):(ft=!1,i=_qs("."+n.persistentButtonClassName,_d.body),(t===null||t===void 0?void 0:t.type)==="resize"&&i&&n.elementHasClass(n.hoverContainerSub,"b_scpers")?(r=n.getClientRect(i),vt({top:r.top+n.PixelUnit,left:r.left+n.PixelUnit})):s())}function s(t){var r=t||n.currentHoveredItem.Element,i;if(n.hoverContainer&&r){if(f(!0),yu(),i=n.getClientRect(r),!i){f(!1);return}var u=i.top,e=i.bottom,o=i.left,s=i.width,h=i.height,c=e>_w.innerHeight?_w.innerHeight-u:h;vt({width:s+n.PixelUnit,height:c+n.PixelUnit,top:u+kt+n.PixelUnit,left:o+bt+n.PixelUnit});f(!1)}}function ai(){n.hoverContainer&&ci("block")}function b(){n.hoverContainer&&(ci("none"),sj_evt.fire("onHoverContainerHide"))}function ru(t){var i=n.currentHoveredItem.Element;i&&n.hoverContainerSub&&(n.elementHasClass(i,t)?n.addElementClass(n.hoverContainerSub,t):hi(t))}function uu(){if(!e()){var t=vi(null);if(t){if(a(),!v(t)){a();return}n.hoverContainer&&(s(),ai(),n.removeElementClass(n.hoverContainerSub,"b_scpers"),n.iterateThroughList(n.RemovableCN,ru));sj_evt.fire(n.ControlAppendedEN)}}}function fu(t){if(!e()){var i=t[n.RelatedTargetAttr];if(i||b(),i&&n.hoverContainer){if(n.elementContains(n.ctrl,i))return;n.isElementInSpaceOfAnother(i,n.hoverContainer)||b()}}}function vi(n){tt&&sb_ct(tt);var t=wt;return wt=n,n&&(tt=sb_st(uu,er*2)),t}function eu(t){if(!e()){var i=t[n.CurrentTargetAttr];n.currentFocusTarget=t.target;i&&n.isSavableEntity(i)?vi(i):sj_pd(t)}}function ou(t){var i,r,f,u,o;if(!e()){if(i=t[n.CurrentTargetAttr],r=t[n.RelatedTargetAttr],!r){if(f=t[n.TargetAttr],t.type!=="mouseleave"&&n.elementContains(i,f))return;b();return}if(!n.elementContains(n.ctrl,r)&&n.isSavableEntity(i)&&!n.elementContains(i,r)){for(u=r;!n.isSavableEntity(u)&&u[n.ParentElementAttr];)u=u[n.ParentElementAttr];if(o=n.isSavableEntity(u),t.type==="focusout"&&!n.elementContains(i,r)&&!n.shiftKeyDown&&n.tabKeyDown&&o){n.nextFocusable=r;n.ctrlBtn.focus();sj_evt.fire(n.SaveButtonFocusEN);n.tabKeyDown=!1;return}n.hoverContainer&&b();n.iterateThroughList(n.RemovableCN,hi);n.iterateThroughList([n.HoverCN,n.FocusCN,n.SaveCtrlHoveredCN,n.CurrentElementCN],function(t){n.removeElementClass(i,t)});n.currentHoveredItem.Element===i&&(a(),n.currentFocusTarget==null)}}}function yi(t){t&&(n.addInListeners(t,eu),n.addOutListeners(t,ou),n.isSavableEntity(t)&&wi(t))}function k(n,t,i){return(i===void 0&&(i=""),n&&n.children&&t)?n.querySelectorAll("."+t+i):[]}function pi(t){return t?k(t,n.SavableEntityCN):[]}function d(t){if(t){if(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.bclist){var i=n.ctrl.dataset.bclist.toLowerCase().split(",");if((i===null||i===void 0?void 0:i.indexOf(n.compName===null||n.compName===void 0?void 0:n.compName.toLowerCase()))>-1)return}n.isSavableEntity(t)?yi(t):n.iterateThroughList(pi(t),yi)}}function wi(n){if(n){var t=o(n);t&&p(n,ot(t)||ri(t))}}function su(t){var i=t;i&&(i.type==="attributes"&&i.target&&n.iterateThroughList(pi(i.target),function(n){d(n);wi(n)}),n.ctrl&&i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,d))}function hu(t){n.partnerCount!==1||ut?(l.observe(t,nt),n.ctrl&&d(t)):(n.containerElement=t,typeof g.getCollections!==n.UndefinedString&&(g.getCollections(n.urlParams,function(n){return cu(n,t)},function(){return i(3,null)}),ut=!0))}function cu(t,i){var r=nu(t);return l.observe(i,nt),n.ctrl&&d(i),r}function lu(t){for(var i=t,u={scroll:1,overlay:1,auto:1},r;i&&i.parentElement&&i!==(_d===null||_d===void 0?void 0:_d.body);){if(i.hasAttribute(n.ScrollBindDataAttr))break;r=_w===null||_w===void 0?void 0:_w.getComputedStyle(i);(r.overflow in u||r.overflowX in u||r.overflowY in u)&&(n.addListenerToElement(i,"scroll",function(){s()}),i.setAttribute(n.ScrollBindDataAttr,"1"));i=i.parentElement}}function bi(t){n.registerPartnerAndComponent(t,hu);(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.cstmui)&&wu();lu(t)}function ki(t){var r,i,u,f;if(t&&(n.elementHasClass(t,n.SaveCtrlContainerCN)?t.dataset.svcptid&&bi(t):n.elementHasClass(t,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner),r=t.children,r))for(i=0,u=r;i<u.length;i++)f=u[i],ki(f)}function au(t){var i=t;i&&(i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,ki),i.removedNodes&&i.removedNodes.length>0&&n.iterateThroughList(i.removedNodes,function(t){n.elementHasClass(t,n.persistentButtonClassName)&&sj_evt.fire(n.DeregisterPersBtnEN)}),i.attributeName&&i.target&&n.elementHasClass(i.target,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner))}function yt(t){t&&n.iterateThroughList(t,bi)}function di(t){return new MutationObserver(function(i){return n.iterateThroughList(i,t)})}function gi(n){var t=n[1],i=n[2],u,r;t&&i&&(u=i&&ht(i),u)&&(r=y(t),r&&p(r,t,!1))}function nr(n){var t=n[1],r=n[2],i;t&&(i=y(t),fi(t,r),i&&lt(i,t,!1))}function vu(t,i){var f,r;i===void 0&&(i=!1);var h=t.id,e=t.title,o=t.collectionPage,s=t.knownCollectionType,u=s?Constants.PredefinedCollections[s]:h;!n.localCollectionsMap[u]&&e&&(w(u,e),r=null,o&&((f=o.items)===null||f===void 0?void 0:f.length)&&(r=ti(o),r&&sj_evt.fire("onChangeCollThumbnail",u,r)),sj_evt.fire(n.CollRegisterEN,i,u,e,r,s||null))}function yu(){bt=_w.scrollX||_w.pageXOffset;kt=_w.scrollY||_w.pageYOffset}function tr(){(n.flyoutContainer===null||n.flyoutContainer===void 0?void 0:n.flyoutContainer.dataset.ebc)&&typeof CollChannel.CollectionsBroadcastChannel!="undefined"&&(t=new CollChannel.CollectionsBroadcastChannel(bu,null,null,!1),t===null||t===void 0?void 0:t.initialize())}function ir(t){var i=t[1],r=t[2],u=t[3],f=t[4],e=t[5];v(r,u,f,e);s(i);ai();n.addElementClass(n.hoverContainerSub,"b_scpers");sj_evt.fire(n.ControlAppendedEN)}function pu(){var t=_d.querySelector(":root"),i,r;t&&(t.style.setProperty(n.IcnsBGColorCss,n.SavePromClrCss),t.style.setProperty(n.IcnLblTxtClrCss,n.SavePromTxtClrCss),i=getComputedStyle(t).getPropertyValue(n.SavedPromIcnCss),t.style.setProperty(n.SavedIcnCss,i),r=getComputedStyle(t).getPropertyValue(n.UnsavedPromIcnCss),t.style.setProperty(n.UnsavedIcnCss,r))}function wu(){n.customUIObj&&n.flyoutContainer&&(n.customUIObj.BGColor&&n.flyoutContainer.style.setProperty(n.FlyoutBGClrCss,n.customUIObj.BGColor),n.customUIObj.TextColor&&n.flyoutContainer.style.setProperty(n.FlyoutTxtClrCss,n.customUIObj.TextColor),n.customUIObj.LinkColor&&n.flyoutContainer.style.setProperty(n.FlyoutLnkClrCss,n.customUIObj.LinkColor))}function bu(){return}function rr(t){var i=t[1];yt(k(_d.body,n.SaveCtrlContainerCN));h?v(i):c=i}function ur(){yt(k(_d.body,n.SaveCtrlContainerCN));n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner)}function fr(){sj_evt.unbind(n.FavAddEN,gi);sj_evt.unbind(n.FavDeleteEN,nr);sj_evt.unbind("ajax.unload",fr);sj_evt.unbind(n.PersButtonInteractEN,ir);sj_evt.unbind(n.CollBCLoadedEN,tr);sj_evt.unbind(n.CurrentElementSetEN,rr);sj_evt.unbind(n.UpdateSaveStateEN,ur);_d.body.removeChild(n.hoverContainer);it.disconnect();l.disconnect();t===null||t===void 0?void 0:t.close()}function ku(){sj_evt.bind(n.FavDeleteEN,nr);sj_evt.bind(n.FavAddEN,gi);sj_evt.bind(n.PersButtonInteractEN,ir);sj_evt.bind("ajax.unload",fr);sj_evt.bind(n.CurrentElementSetEN,rr,!0);sj_evt.bind(n.UpdateSaveStateEN,ur,!0);sj_evt.bind(n.CollBCLoadedEN,tr,!0)}function du(){n.localSavedItemsMap={};n.localCollectionsMap={};n.localCollectionsCidMap={};n.cidToThumbnailUrlMap={};n.localCollectionNames={};n.latestCollId=null;n.partners=[];n.currentHoveredItem={Element:null,LatestCollId:null,Metadata:null,Mid:null,Turl:null}}function gu(){var t,i;n.ctrl=_ge("svctrl");n.ctrl&&(f(!1),n.addListenerToElement(n.ctrl,"mousedown",sj_sp));n.ctrlBtn=_ge("svctrlbtn");n.hoverContainer=_ge("svhvr");n.hoverContainerSub=_ge("svhvrsub");n.hoverContainer&&(_d.body.insertBefore(n.hoverContainer,_d.body.firstChild),n.addOutListeners(n.hoverContainer,fu));du();l=di(su);it=di(au);it.observe(_d.body,nt);n.flyoutContainer=_ge("svflytc");n.flyoutContainer&&n.flyoutContainer.hasAttribute("data-svlne")&&(n.standalone=!!n.flyoutContainer.getAttribute("data-svlne"));n.standalone||yt(k(_d.body,n.SaveCtrlContainerCN));ku();n.addListenerToElement(_w,n.ScrollEvent,s);n.addListenerToElement(_w,n.ResizeEvent,iu);dt=n.debounce(function(){n.tabKeyDown=!1},1e3);_w.addEventListener("keydown",function(t){!n.shiftKeyDown&&t.shiftKey?n.shiftKeyDown=!0:n.tabKeyDown||t.key!="Tab"||(n.tabKeyDown=!0)});_w.addEventListener("keyup",function(t){!t.shiftKey&&n.shiftKeyDown?n.shiftKeyDown=!1:n.tabKeyDown&&t.key=="Tab"&&dt()});(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.isprom)&&pu();r=(t=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset)===null||t===void 0?void 0:t.svctrlv3;gt=(i=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset)===null||i===void 0?void 0:i.svctrlv3dynsug}var g=MySavesAPIUtils;n.containerElement=null;n.shiftKeyDown=!1;n.tabKeyDown=!1;n.kctColls={};var nt={childList:!0,subtree:!0,attributes:!0},pt,h=!1,c=null,tt,it,l,rt,wt,er=0,bt=0,kt=0,t,ut=!1,dt=null,r=null,gt=null,ni,ft=!1,et=500,or="aria-label";n.setKeepFlyoutActive=f;n.getKeepFlyoutActive=e;n.clearCurrentHoveredItem=a;n.metadataFromElement=o;n.clearTempCurrentElement=sr;n.getThumbnailUrlFromCollectionPage=ti;n.getMetadataId=ot;n.handleSaveClick=hr;n.collectionPickerItemListener=cr;n.fireSCEngagementEvent=st;n.addItemSuccessCB=u;n.handleError=i;n.addCollectionName=w;gu()}(SvCtrlV2||(SvCtrlV2={})),function(n){function dt(t){if(i){t||(t=n.currentHoveredItem.Mid);var u=t&&n.localSavedItemsMap[t],e=r||!u,f=e?n.latestCollId:u.lastCollection,o=f&&n.localCollectionsMap[f]||n.defOrCustCollName;vt(f,o,u?u.numCollections:0)}}function at(t,i){if(t&&ht!==t){n.removeElementClass(ht,"b_sclbl");n.addElementClass(t,"b_sclbl");ht=t;n.removeElementClass(bt,n.SublabelActiveCN);var r=t.querySelector(i?"onsvd":"onusvd");n.addElementClass(r,n.SublabelActiveCN);bt=r}}function li(t){sj_sp(t);var i=t.target.value.trim(),r=n.isCollectionExists(i);b.setAttribute("aria-disabled",i&&!r?"false":"true");r?n.addElementClass(l,n.ErrDispCN):n.elementHasClass(l,n.ErrDispCN)&&n.removeElementClass(l,n.ErrDispCN)}function gt(t){var i,r=t[1],u=n.currentHoveredItem.Mid;vt(r,n.localCollectionsMap[r],u&&((i=n.localSavedItemsMap[u])===null||i===void 0?void 0:i.numCollections));lt=!1}function ai(t){var i=t[1],r;i==5?(n.removeElementClass(et,n.errStateInvisibleCN),n.addElementClass(et,n.errStateVisibleCN)):nt&&(o.textContent=nt[i],n.removeElementClass(o,n.errStateInvisibleCN),n.addElementClass(o,n.errStateVisibleCN));n.logErrorState(n.currentHoveredItem.Element,n.UiErrorStates[i]);r=n.currentHoveredItem.Mid;n.fireSCEngagementEvent(0,0,0,r&&n.localSavedItemsMap[r]?n.localSavedItemsMap[r].numCollections:0,n.UiErrorStates[i]);p(e)}function vi(t){var i,u,h=t[0],o=t[1],s=t[2],f=t[3],e=n.currentHoveredItem.Mid;f!==0&&(!r||((i=n.localSavedItemsMap[e])===null||i===void 0?void 0:i.collections[n.latestCollId]))?(!r||r&&((u=n.localSavedItemsMap[e])===null||u===void 0?void 0:u.collections[n.latestCollId]))&&n.addElementClass(n.hoverContainerSub,n.SavedCN):n.removeElementClass(n.hoverContainerSub,n.SavedCN);vt(o,s,f)}function yi(){var h;if(n.ctrl&&(h=n.ctrl.dataset,h)){var y=h.dly,tt=h.sfmc,p=h.svctrlv3,w=h.svctrlv3dynsug;y&&(ct=parseInt(y,10));n.savedFormCode||(n.savedFormCode=tt);p&&(r=p);w&&(kt=w)}c=_ge("svctrlinlineform");ut=_ge("svctrlnewint");b=_ge("svctrlinlineformcreate");a=_ge("svctrlhvr");t||(t=_ge("svflytc"));i=_ge("svctrllnk");g=_ge("sccolltxt");wt=i.getAttribute("href");st=_ge("svctrlhvrnum");e=_ge("svctrlerr");o=_ge("svctrlerrtxt");u=_ge("svctrlhvrbtn");ft=_ge("svctrllstw");k=_ge("svctrlhvrpnl");et=_ge("svctrlmsmtcherrtxt");d=_ge("svctrlmsmtchlnk");v=_ge("svctrlhvrpnlbtn");l=_ge("svctrlinlineformerrdup");ot=_ge("svctrlinlineformback");c&&(f=_ge("svctrlinlineformname"),n.addClickListener(ot,ii),n.addClickListener(b,ui),f&&(n.addEnterKeyListener(f,ui),n.addListenerToElement(f,"keyup",li)));i&&n.isAnchorElement(i)&&n.addClickListener(i,ci);d&&n.isAnchorElement(d)&&n.addClickListener(d,ci);t&&(n.standalone||n.addOutListeners(t,tr),r||(n.addInListeners(n.ctrlBtn,rr),n.addOutListeners(n.ctrlBtn,ur)),a&&n.addClickListener(u,nr),n.addClickListener(_ge("svctrltri"),fr,!1),t.hasAttribute(n.SaveErrorMapAttr)&&(nt=n.parseJsonString(t.getAttribute(n.SaveErrorMapAttr))));sj_evt.bind(n.ControlAppendedEN,er);sj_evt.bind("onSaveInProgress",di);sj_evt.bind(n.SaveAddEN,bi);sj_evt.bind(n.SaveDelEN,ki);sj_evt.bind("onHoverContainerHide",it);sj_evt.bind(n.CurrentCollIdSetEN,gt);sj_evt.bind(n.UpdateHoverBoxEN,vi);sj_evt.bind(n.SaveButtonClickEN,s);sj_evt.bind(n.LoadingSuggestedCollection,or);n.standalone||sj_evt.bind(n.CollListExpandEN,oi);sj_evt.bind(n.SaveControlErrorEN,ai);n.standalone&&(sj_evt.bind(n.CollectionsGottenEN,wi),sj_evt.bind(n.HostSavesControlClickedEN,pi));sj_evt.bind(n.SaveButtonFocusEN,gi)}function pi(t){var i=t[0],r=t[1];i==n.HostSavesControlClickedEN&&(s(),yt(r))}function wi(t){var i=t[0];i==n.CollectionsGottenEN&&h!=e&&(gt([null,n.currentHoveredItem.LatestCollId||n.latestCollId]),p(a),si())}function ni(t){var i;dt(t);(!r||n.isCreateDialogShowing)&&s();ri((i=n.localSavedItemsMap[t])===null||i===void 0?void 0:i.numCollections)}function bi(t){var i,u=t[3];n.currentHoveredItem.Element===u&&(ni(n.currentHoveredItem.Mid),(!r||((i=n.localSavedItemsMap[n.currentHoveredItem.Mid])===null||i===void 0?void 0:i.collections[n.latestCollId]))&&n.addElementClass(n.hoverContainerSub,n.SavedCN))}function ki(t){var i=t[3],r=t[4];n.currentHoveredItem.Element===i&&(ni(n.currentHoveredItem.Mid),r&&n.removeElementClass(n.hoverContainerSub,n.SavedCN))}function ti(){n.removeElementClass(e.querySelector("."+n.SublabelActiveCN),n.SublabelActiveCN)}function di(t){var i=t[1],r=t[2];n.standalone||(ti(),n.currentHoveredItem.Element===i&&at(_ge("svctrlhvrpnling"),r))}function gi(){t&&s()}function ii(){u&&c&&(n.removeElementClass(k,n.DeactivateCN),n.removeElementClass(ft,n.DeactivateCN),n.removeElementClass(c,n.FlyoutActiveCN),n.removeElementClass(u,n.DeactivateCN),n.addElementClass(u,n.FlyoutActiveCN),n.setKeepFlyoutActive(!1),f.value="",f.disabled=!0,u.setAttribute("tabindex","0"),i.setAttribute("tabindex","0"),v&&v.setAttribute("tabindex","0"),n.collectionList&&n.collectionList.setAttribute("tabindex","0"),n.isCreateDialogShowing=!1)}function nr(){(n.clearTempCurrentElement(),u&&c)&&(n.addElementClass(k,n.DeactivateCN),n.addElementClass(ft,n.DeactivateCN),n.addElementClass(u,n.DeactivateCN),n.addElementClass(c,n.FlyoutActiveCN),n.removeElementClass(u,n.FlyoutActiveCN),n.setKeepFlyoutActive(!0),f.value="",f.disabled=!1,f.focus(),n.removeElementClass(l,n.ErrDispCN),b.setAttribute("aria-disabled","true"),u.setAttribute("tabindex","-1"),i.setAttribute("tabindex","-1"),v&&v.setAttribute("tabindex","-1"),n.collectionList&&n.collectionList.setAttribute("tabindex","-1"),n.isCreateDialogShowing=!0)}function ri(n){if(st&&n!==undefined&&n!==null){var t=n-1;r||(st.textContent=t>0?"+"+t:"")}}function vt(u,f,e){var s,h=n.standalone&&((s=t===null||t===void 0?void 0:t.dataset)===null||s===void 0?void 0:s.htc)&&(!e||e==0),o;(h?(i.textContent=t.dataset.htc,rt=""):(i.textContent=f,rt=u,r&&g&&(!lt||!kt)&&(g.textContent=f)),n.isAnchorElement(i))&&(o=wt,n.savedFormCode&&(o+="&FORM="+n.savedFormCode),h||(o+="&collId="+u),i.setAttribute("href",o),n.savedLinkSameTab&&i.hasAttribute(n.TargetAttr)?i.removeAttribute(n.TargetAttr):i.setAttribute(n.TargetAttr,"_blank"),ri(e))}function ui(){var i,t;if(n.logCreateButtonClick(n.currentHoveredItem.Element),t=(i=f.value)===null||i===void 0?void 0:i.trim(),t){if(n.isCollectionExists(t)){n.addElementClass(l,n.ErrDispCN);return}p(ut);n.addToNewCollection(n.addItemSuccessCB,n.handleError,t)}}function fi(t){n.nextFocusable.focus();n.nextFocusable=null;sj_pd(t)}function tr(i){var r,u;if(!n.getKeepFlyoutActive()){if(r=i[n.RelatedTargetAttr],i.type==="focusout"&&!n.elementContains(t,r)&&n.nextFocusable){u=+n.ctrl.dataset.nfdly||0;u>0?sb_st(function(){return fi(i)},u):fi(i);return}if(r){if(n.isElementInSpaceOfAnother(t,r))return;if(n.elementContains(n.ctrl,r))return;if(n.isElementInSpaceOfAnother(n.ctrl,r))return}i[n.TargetAttr]!==ot&&(it(),n.clearCurrentHoveredItem())}}function ei(){y&&(sb_ct(y),y=null)}function oi(){var i,u,v,h,c,l,y,e;if(t&&(n.removeElementClass(n.ctrl,n.NarrowImageCN),t.style.removeProperty("left"),t.style.removeProperty("right"),t.style.removeProperty("bottom"),n.removeElementClass(n.ctrl,n.NarrowImageRightCN),n.removeElementClass(n.ctrl,n.NarrowImageBottomCN),i=n.getClientRect(t),i)){var f=Math.min(n.getClientRect(_d.body).width,_w.innerWidth),a=i.width,o=i.right,s=i.left;if(s<0?o+a>f?(n.addElementClass(n.ctrl,n.NarrowImageCN),u=(o-f)/2,s+u<=0&&(u-=tt),t.style.right=u+"px"):n.addElementClass(n.ctrl,n.NarrowImageRightCN):o>f&&(s<a?(n.addElementClass(n.ctrl,n.NarrowImageCN),u=s/2,o-u>=f&&(u+=tt),t.style.left=-1*u+"px"):n.elementHasClass(n.hoverContainerSub,"b_scpers")?i&&i.right>f?(v=f-i.right,t.style.left=v-tt+"px"):n.addElementClass(n.ctrl,n.NarrowImageRightCN):n.addElementClass(n.ctrl,n.NarrowImageRightCN)),h=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.flyoutpos,c=h?3:1,i=n.getClientRect(t),l=Math.min(n.getClientRect(_d.body).height,_w.innerHeight)-i.bottom,y=k.clientHeight+Math.min(3.5,Object.keys(n.localCollectionsMap).length)*48,l<t.clientHeight/c||l<y/c)if(n.addElementClass(n.ctrl,n.NarrowImageBottomCN),h){var b=n.getClientRect(n.ctrlBtn),d=n.getClientRect(n.currentHoveredItem.Element),g=_qs(".svbtnlbl",n.ctrlBtn);i=n.getClientRect(t);g&&(e=n.getClientRect(g),b.left-d.left<d.right-b.right?i.left-e.right<0&&e.right-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"):i.left-e.left<0&&e.left-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"))}else{var p=n.ctrlBtn.clientLeft,nt=n.ctrlBtn.clientWidth,w=t.clientLeft,it=t.clientWidth;p>=w&&p+nt<=w+it&&(t.style.bottom=(r?n.ctrl.clientHeight+tt:n.ctrlBtn.clientHeight)+"px")}}}function ir(){p(a);at(_ge("svctrlhvrpnltxt"),!0)}function si(){t&&(n.addElementClass(n.ctrl,n.HasFlyoutCN),ti(),n.standalone||oi(),pt&&n.standalone||(n.logFlyoutShown(n.currentHoveredItem.Element),pt=!0),sj_evt.fire("onResetScroll"),w=!0,ei())}function it(){t&&(n.removeElementClass(n.ctrl,n.HasFlyoutCN),p(),ei(),w=!1)}function s(){ir();w||si()}function hi(){s();sj_evt.fire("prismFocusChange",n.currentHoveredItem.Element)}function rr(i){i.relatedTarget&&(n.getKeepFlyoutActive()||(sj_pd(i),sj_sp(i),n.addElementClass(n.ctrl,n.HasFlyoutCN),n.logSvBtnHoverEvent(),n.hoverContainerSub&&n.addElementClass(n.hoverContainerSub,"b_schvr"),sj_evt.fire("onSaveHover"),t&&(ct&&!y?y=sb_st(hi,ct):hi())))}function ur(t){if(t.type==="focusout"){if(n.shiftKeyDown){n.currentFocusTarget&&n.currentFocusTarget.focus();t.stopImmediatePropagation();sj_sp(t);sj_pd(t);return}s();n.elementHasClass(e,n.FlyoutActiveCN)?n.nextFocusable.focus():h.focus();return}if(!n.getKeepFlyoutActive()){var i=t.relatedTarget;if(i){if(n.elementContains(n.ctrl,i))return;if(n.isElementInSpaceOfAnother(n.hoverContainer,i))return}n.clearCurrentHoveredItem();t.type==="mouseleave"&&(n.removeElementClass(n.ctrl,n.HasFlyoutCN),it())}}function fr(t){var i=n.elementsFromPoint(t.clientX,t.clientY);i&&i.length>1&&i[1].click()}function ci(t){var i=t[n.TargetAttr];si_ct(i,!1,t);n.logLinkClick(n.currentHoveredItem.Element,rt);n.standalone&&(sj_evt.fire("onNewTabOpenRequest",i.getAttribute("href")),t.preventDefault());sj_sp(t)}function p(t){var f,i,r,s;if(h&&(n.removeElementClass(h,n.FlyoutActiveCN),f=t==ut,n.setKeepFlyoutActive(f),n.getKeepFlyoutActive()?n.addElementClass(n.ctrl,"b_scnapd"):n.removeElementClass(n.ctrl,"b_scnapd")),!t){h=null;sj_evt.fire(n.VisualStateChangedEN,1);return}n.elementHasClass(n.ctrl,"b_geterr")&&(o.textContent=nt[3],n.removeElementClass(o,n.errStateInvisibleCN),n.addElementClass(o,n.errStateVisibleCN),t=e);n.addElementClass(t,n.FlyoutActiveCN);t==a&&(n.addElementClass(u,n.FlyoutActiveCN),ii());h=t;i=null;switch(t){case a:r=_ge("svctrlpckr");r?(s=r.getAttribute("aria-expanded")==="false",i=s?3:4):i=3;break;case e:i=5}sj_evt.fire(n.VisualStateChangedEN,i)}function er(){i&&(dt(),sj_evt.fire(n.VisualStateChangedEN,2))}function yt(t){var i=n.localSavedItemsMap[n.currentHoveredItem.Mid];i&&i.numCollections>1&&!r?sj_evt.fire(n.ChevronToggleCollListEN):n.handleSaveClick(r?n.latestCollId:n.currentHoveredItem.LatestCollId||n.latestCollId,"Btn",t)}function or(){g.textContent=". . .";lt=!0}function sr(){w?it():s()}function hr(){yt(!0);at(_ge("svctrlhvrpnltxt"),!0)}var pt=!1,rt,w=!1,h,u,c,f,b,ut,e,o,l,ft,k,et,d,v,ot,t,a,g,i,wt,st,ht,bt,ct=0,y,nt,r=null,kt=null,lt=!1,tt=5;n.isCreateDialogShowing=!1;n.onSaveControlClicked=yt;n.toggleFlyout=sr;n.onSaveControlIcnClicked=hr;yi()}(SvCtrlV2||(SvCtrlV2={})),function(n){function c(){s.scrollTop=0}function l(n){var t=n;if(/\/th(\/.*|)\?/i.test(n)){var i=n.split("?"),r=i[0],u=i[1];t=r+"?"+u.replace(/&?\b[whrc]=\d+/gi,"")+y}return t}function p(t){var u=t[1],r=t[2],i=_qs("["+n.CollectionIdDataAttribute+'="'+u+'"] img',n.collectionList);i&&(r?i.src=l(r):i.removeAttribute("src"))}function r(t,i,r){r===void 0&&(r=!1);var u=r?function(n){t.insertBefore(n,t.firstChild)}:function(n){t.appendChild(n)};n.iterateThroughList(i,u)}function i(t,i){var r=function(n,i){i&&t.setAttribute(n,i)};n.iterateOverObject(i,r)}function u(n,t){return sj_ce(n,null,t)}function w(t){var f,y=t[1],p=t[2],w=t[3],v=t[4],b=t[5],k=t[6],h,e,c,a,s;n.collectionList&&(h=u("div","b_svcimg"),e=sj_ce("img"),i(e,{role:"presentation"}),sj_be(e,"error",function(){e.removeAttribute("src")}),v&&(e.src=l(v)),r(h,[e]),c=u("div","b_svclnk"),a=u("p","b_ignbt"),a.textContent=w,r(c,[a]),s=u("li","b_svcitm"),i(s,(f={},f[n.CollectionIdDataAttribute]=p||null,f[n.KCTDataAttr]=b||null,f.tabindex="-1",f.role="option",f["aria-selected"]="false",f)),k&&o(s),r(s,[h,c]),r(n.collectionList,[s],y),n.addClickListener(s,n.collectionPickerItemListener,!0,!1))}function e(r){var u,e;c();u=!1;r===null||r===undefined?(e=f.getAttribute("aria-expanded"),e!=="false"||h||(n.logCollExpandClick(n.currentHoveredItem.Element),h=!0),u=e==="true"?!1:!0):u=r;i(f,{"aria-expanded":u?"true":"false"});u?n.addElementClass(t,"xpnd"):n.removeElementClass(t,"xpnd");u&&sj_evt.fire(n.CollListExpandEN);n.standalone&&sj_evt.fire(n.VisualStateChangedEN,u?4:3)}function a(t){return _qs("["+n.CollectionIdDataAttribute+"='"+t+"']",n.collectionList)}function o(t){var r;i(t,(r={},r[n.SavedDataAttr]="1",r["aria-selected"]="true",r))}function v(t){var r;t.removeAttribute(n.SavedDataAttr);i(t,(r={},r["aria-selected"]="false",r))}function b(n){var i=n[1],t=a(i);t&&o(t)}function k(n){var i=n[1],t=a(i);t&&v(t)}function d(t){var i=t[1];n.iterateThroughList(Array.prototype.slice.call(n.collectionList.childNodes),function(t){i&&t.getAttribute(n.CollectionIdDataAttribute)in i?o(t):v(t)})}function g(t){var i;n.isCreateDialogShowing||(t.keyCode===38?(_d.activeElement.previousElementSibling&&_d.activeElement.previousElementSibling.focus(),sj_sp(t),sj_pd(t)):t.keyCode===40&&(_d.activeElement===n.collectionList?(i=_qs(".b_svcitm"))===null||i===void 0?void 0:i.focus():_d.activeElement.nextElementSibling&&_d.activeElement.nextElementSibling.focus(),sj_sp(t),sj_pd(t)))}function nt(t){if(!t||!n.collectionList)return!1;var i=_qs("[".concat(n.CollectionIdDataAttribute,'="').concat(t,'"]'),n.collectionList);return i?(n.collectionList.removeChild(i),!0):!1}function tt(){n.collectionList=_ge("svctrllst");f=_ge("svctrlpckr");s=_ge("svctrllstw");t=_ge("svctrlhvrpnlbtn");t&&n.addClickListener(t,function(){return e()});sj_evt.bind(n.CollRegisterEN,w,!0);sj_evt.bind(n.CurrentCollIdSetEN,b);sj_evt.bind(n.CurrentCollIdUnsetEN,k);sj_evt.bind("onChangeCollThumbnail",p);sj_evt.bind("onResetScroll",c);sj_evt.bind(n.HoverElementSetEN,d);sj_evt.bind(n.ChevronToggleCollListEN,function(){return e(!0)});sj_evt.bind(n.ControlAppendedEN,function(){return e(!1)});sj_evt.bind("onSaveHover",function(){t||sj_evt.fire(n.CollListExpandEN)});n.collectionList&&n.addListenerToElement(n.collectionList,"keydown",g)}var f,s,t,h=!1,y="&w=40&h=40&c=7&r=0";n.removeCollectionFromPicker=nt;tt()}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(t){n.fireOverlapping(t);sj_sp(t);var i=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.svicnclkb;if(sj_evt.fire(n.SaveButtonClickEN),sj_evt.fire(n.ChevronToggleCollListEN),i==="OpenSave"||i==="OpenSaveRemove")n.onSaveControlClicked(i==="OpenSave"?!1:!0)}function i(){n.ctrlBtn&&n.addClickListener(n.ctrlBtn,t,!0)}i()}(SvCtrlV2||(SvCtrlV2={}))